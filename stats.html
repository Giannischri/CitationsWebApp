<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Create &mdash; Onepage Website Template by Colorlib</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
    <link rel="stylesheet" href="fonts/icomoon/style.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">

    <link rel="stylesheet" href="css/jquery.fancybox.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">

    <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/style.css">
    
  </head>
  <body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
  
  <div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
   
    <div class="border-bottom top-bar py-2 bg-dark" id="home-section">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <p class="mb-0">
              <span class="mr-3">
                <span><strong id="usernamelbl" style="color:rgb(0, 252, 239)" type="hidden">Username:</strong> <label style="color:red" id="username"></label></span>
                <span><strong id="rolelbl" style="color:rgb(0, 252, 239)" type="hidden">Role:</strong> <label style="color:red" id="role"></label></span>
                <span><button id="logout" class="btn btn-outline-danger" style="display:none;" onclick="logout()">Logout</button></span>
            </p>
          </div>
          <div class="col-md-6">
            <div class="form-popup" id="loginform" style="display:none">
              <form action="login.php" method="POST" class="form-container" >
                <h1 style="color:red">Login</h1>
                <label for="email"><b style="color:red">Email</b></label>
                <input type="text" placeholder="Enter Email" name="email" required>
            
                <label for="psw"><b style="color:red">Password</b></label>
                <input type="password" placeholder="Enter Password" name="psw" required>
              
               
              
            
                <button type="submit" name="logsub" class="btn btn-outline-primary">Login</button>
                <button type="button"  class="btn btn-outline-danger" onclick="closeForm()">Close</button>
              </form>
            </div>
            <ul class="social-media">
              <li><a href="#" class="p-2"><span class="icon-facebook"></span></a></li>
              <li><a href="#" class="p-2"><span class="icon-twitter"></span></a></li>
              <li><a href="#" class="p-2"><span class="icon-instagram"></span></a></li>
              <li><a href="#" class="p-2"><span class="icon-linkedin"></span></a></li>
            </ul>
          </div>
        </div>
      </div> 
    </div>

    <header class="site-navbar py-4 bg-white js-sticky-header site-navbar-target" role="banner">

      <div class="container">
        <div class="row align-items-center">
          
        
           
            
            <img src="images/logo.png"/>
            <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">Icsd-Postmaker<span class="text-primary">.</span> </a></h1>
          
         
       
        
          <div class="col-12">
            <nav class="site-navigation position-relative text-right" role="navigation">

              <ul id="toplis" class="site-menu main-menu js-clone-nav mr-auto d-none d-lg-block">
                <li><a href="index.html" class="nav-link" style="color:rgb(0, 252, 239)">Home</a></li>
               
                
                <li><a href="postan.html" style="color:rgb(0, 252, 239)">Post annaouncement</a></li>
                <li id="profilebtn"><a href="profile.html" style="color:rgb(0, 252, 239)" class="nav-link">Profile</a></li>
                <li>
                  <a href="stats.html" style="color:rgb(0, 252, 239)" class="nav-link">Statistics</a>
                </li>
                <li id="adminbtn"><a href="admin.html" style="color:red" class="nav-link">Admin</a></li>
                <li id="loginbtn"><a href="javascript:openForm();" style="color:red" class="nav-link">Login</a></li>
                <li  id="signupbtn"><a href="signup.html" style="color:red" class="nav-link">Sign up</a></li>
              </ul>
            </nav>
          </div>


          <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>

        </div>
      </div>
    </div>
      
    </header>
    <div class="site-blocks-cover overlay" style="background-image: url(images/stats.png);" data-aos="fade"
    data-stellar-background-ratio="0.5">
    <div class="container">
      <div class="row align-items-center justify-content-center text-center">


      </div>
    </div>
  </div>
    
  

    

    

    <section class="site-section">
      <div class="container">
      <div class="row" id="stats1">
        
        
      </div>
        <div  class="row">
          <canvas id="bar-chart" width="800" height="450"></canvas>

    </div>
  </div>
    </section>

    
  
    
    
    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <div class="col-md-5">
                <h2 class="footer-heading mb-4">About Us</h2>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Neque facere laudantium magnam voluptatum autem. Amet aliquid nesciunt veritatis aliquam.</p>
              </div>
              <div class="col-md-3 ml-auto">
                <h2 class="footer-heading mb-4">Features</h2>
                <ul class="list-unstyled">
                  <li><a href="#">About Us</a></li>
                  <li><a href="#">Services</a></li>
                  <li><a href="#">Testimonials</a></li>
                  <li><a href="#">Contact Us</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <h2 class="footer-heading mb-4">Follow Us</h2>
                <a href="#" class="pl-0 pr-3"><span class="icon-facebook"></span></a>
                <a href="#" class="pl-3 pr-3"><span class="icon-twitter"></span></a>
                <a href="#" class="pl-3 pr-3"><span class="icon-instagram"></span></a>
                <a href="#" class="pl-3 pr-3"><span class="icon-linkedin"></span></a>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <h2 class="footer-heading mb-4">Subscribe Newsletter</h2>
            <form action="#" method="post">
              <div class="input-group mb-3">
                <input type="text" class="form-control border-secondary text-white bg-transparent" placeholder="Enter Email" aria-label="Enter Email" aria-describedby="button-addon2">
                <div class="input-group-append">
                  <button class="btn btn-primary text-white" type="button" id="button-addon2">Send</button>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="row pt-5 mt-5 text-center">
          <div class="col-md-12">
            <div class="border-top pt-5">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart text-danger" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
            </div>
          </div>
          
        </div>
      </div>
    </footer>

  </div> <!-- .site-wrap -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/jquery-migrate-3.0.1.min.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/jquery.countdown.min.js"></script>
  <script src="js/bootstrap-datepicker.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/jquery.fancybox.min.js"></script>
  <script src="js/jquery.sticky.js"></script>
  <script language="JavaScript" type="text/javascript">
  
  function openForm() {
  document.getElementById("loginform").style.display = "block";
}

function closeForm() {
  document.getElementById("loginform").style.display = "none";
}
function logout()
    {
      $.ajax({ url: "functions.php",
            type:'post',
            data: { "logout": "1"},
            success: function(){
             alert("You logged out");
             location.reload();
            }});


    }
    function printstats(data)
    {
      if(document.getElementById('role').innerText=="author" || document.getElementById('role'.innerText=="user"))
      {
        document.getElementById('stats1').innerHTML="<div class='col'>"+
          '<h5>Number of Posts:</h5>'+
          '<h5>Started posting on:'+data.mindateuser+'  Last Post on:'+data.maxdateuser+'</h5>'+
          '<ul>'+
            '<li>Totally:'+data.totaluserposts+'</li>'+
            '<li>Based on type:'+
              '<ul>'+
                '<li>Articles:'+data.totaluserarticles+'</li>'+
                '<li>Inproceedings:'+data.totaluserinproceedings+'</li>'+
                '<li>Books:'+data.totaluserbooks+'</li>'+
                '<li>Inbooks:'+data.totaluserinbooks+'</li>'+
              '</ul>'+
            '</li>'+
          '</ul>'
      }else{
      var numposts="";
      var date="";
      var pubstrings="";
      var yearly=""
      numofposts='<h5>Number of Posts:</h5>'+
          '<ul>'+
            '<li>Totally:'+data.totalposts+'</li>'+
            '<li>Average Authors per post:'+Math.round(data.avg)+'</li>'+
            '<li>Based on type:'+
              '<ul>'+
                '<li>Articles:'+data.articleposts+'</li>'+
                '<li>Inproceedings:'+data.inprocposts+'</li>'+
                '<li>Books:'+data.bookposts+'</li>'+
                '<li>Inbooks:'+data.inbookposts+'</li>'+
              '</ul>'+
            '</li>'+
          '</ul>';
       
          yearly='<h6>Year:'+data.yearposts[0]+'/Posts:'+data.yearposts[1]+'<h6>';
        
        dates='<h5>Dates From-To:</h5>'+
        '<ul>'+
        '<li>Posts:'+data.mindateposts+'-'+data.maxdateposts+'</li>'+
        '<li>Articles:'+data.mindatearticles+'-'+data.maxdatearticles+'</li>'+
        '<li>Inproceedings:'+data.mindateinproc+'-'+data.maxdateinproc+'</li>'+
        '<li>Books:'+data.mindatebooks+'-'+data.maxdatebooks+'</li>'+
        '<li>Inbooks:'+data.mindateinbooks+'-'+data.maxdateinbooks+'</li>'+
        '</ul>';

        for(var i=0;i<data.publishers.length;i++)
        {
          pubstrings+='<li>Publisher Name:'+data.publishers[i].name+'</li>'+
          '<h6>Publisher Posts:'+data.publishers[i].postsnum+'</h6>';
        }
        
        console.log(numofposts);
        var stats1=document.getElementById('stats1').innerHTML="<div class='col'>"+numofposts+"</div><div class='col'>"+
          "<h5>Yearly posts</h5>"+yearly+"</div><div class='col'>"+dates+"</div><div class='col'><h5>Publishers:</h5>"+pubstrings+"</div>";
      }
          
    
    }
    function drawcharts(data)
    {
     if(document.getElementById('role').innerText=="author" || document.getElementById('role'.innerText=="user"))
      {
      new Chart(document.getElementById("bar-chart"), {
    type: 'bar',
    data: {
      labels: ["Total", "Articles", "Inproceedings", "Books", "Inbooks"],
      datasets: [
        {
          label: "Population (millions)",
          backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
          data: [data.totaluserposts,data.totaluserarticles,data.totaluserinproceedings,data.totaluserbooks,data.totaluserinbooks]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Statistics between'+data.mindateuser+'-'+data.maxdateuser
      }
    }
});
    }
    else{
      new Chart(document.getElementById("bar-chart"), {
    type: 'bar',
    data: {
      labels: ["Total", "Articles", "Inproceedings", "Books", "Inbooks"],
      datasets: [
        {
          label: "Population (millions)",
          backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
          data: [data.totalposts,data.articleposts,data.inprocposts,data.bookposts,data.inbookposts]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Statistics between'+data.yearposts[0]+'-'+data.yearposts[1]
      }
    }
});


    }
    }

    </script>
 
            </script>

  <script src="js/main.js"></script>
  <script>
    $(document).ready(function(){
      $.ajax({ url: "functions.php",
              type:'post',
              dataType: 'json',
              data: { "calluser": "1"},
              success: function(data){
                if(data!==""){
                  $('#username').html(data.name);
                $('#role').html(data.role);                
                $('#logout').show();
               // document.getElementById('signbtn').style.display="none";
                //console.log(document.getElementById('signbtn')) ;
                }
              }});
      });
      $(document).ready(function(){
      $.ajax({ url: "functions.php",
              type:'post',
              dataType: 'json',
              data: { "stats": "1"},
              success:function(data){
                if(data!=""){
                       printstats(data);
                       drawcharts(data);
                }
                      
                }
              });
      });
    </script>


  </body>
</html>